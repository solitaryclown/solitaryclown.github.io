---
layout: post
date: 2023-03-13 20:30:50 +0800
title: 欧姆龙FJ通信
author: solitaryclown
categories: 机器视觉
tags: 欧姆龙
excerpt: ""
---
* content
{:toc}


## 1. 欧姆龙FJ输出结果：
	1. 结果输出（消息）
	此功能模块输出格式都是字符串
	字符串的字节由字符数量确定，数值类型的字节数等于设定的整数位个数+小数位个数+小数点（1个）
	例如：
	第一个数据为数值型，它所占的大小为15个字节=整数位10个+小数位数4+小数点
	[![ppQjDzD.png](https://s1.ax1x.com/2023/03/13/ppQjDzD.png)](https://imgse.com/i/ppQjDzD)
	
	2. 串行数据输出
	只能输出数值类型数据，且都是小数类型，可以选择发送ASCII码表示或者二进制表示
	• 发送二进制表示
	每个数据都是固定的4个字节，且发送的都是数值保留3位小数并扩大1000倍的结果
	
  [![ppQjsQe.png](https://s1.ax1x.com/2023/03/13/ppQjsQe.png)](https://imgse.com/i/ppQjsQe)
	• 发送ASCII表示
	
	
	欧姆龙FJ视觉平台和PLC使用TCP/IP通信时注意点：
  1. 接受数据只能用字符类型，即PLC发送数据每个字段都需要使用char类型
	2. 发送数据使用【串行数据输出】模块，然后注意检查发送数据的顺序和PLC接受数据的顺序是不是一样的，在厂内测试通讯时，PLC第一次触发，发送的数据和PLC收到的数据是不一样的，字段数据乱序，视觉平台重启后解决。
## 2. 双端口实践：
	1. 系统设置-》运行模式，设置成”多行随机触发“，然后重启软件。
	2. 重启软件后可以看到会自动运行两个程序界面，一个是Line0一个是line1，新增的Line1中的场景、通信命令等数据都是没有的，不会自动复制，且场景复制机能只能在Line0中使用。
	3. 点击Line0界面，进入设置->多线维护，可以在Line之间复制场景数据，比如把Line0的场景、通信命令宏等数据复制到Line1上
	4. 设置Line1的端口号：选择Line1界面，进入系统设置，配置无协议TCP设置，配置一个端口号，保存设定后就可以使用TCP客户端测试端口的开启/关闭状态了
	




### 2.1. TCP/IP通信
欧姆龙FJ平台作为TCP服务端，PLC或其他设备作为客户端，数据交互：
#### 2.1.1. 数据输入(tcp/ip)
使用标准TCP/IP和FJ进行通信，数据输入需要使用ASCII码，形如“AAA param1 param2”之类的命令形式

#### 2.1.2. 数据输出(tcp/ip)
在欧姆龙FJ视觉系统中，使用标准tcp/ip协议输出数据，实测只有这3个数据输出模块可以正常输出数据：
+ 串行数据输出
  数据可以以数据的ASCII或本身二进制进行输出，数据串行发送，每个字段一个一个发送
  ![](https://s2.xptou.com/2023/03/13/640eca05a5e55.png)
  ![](https://s2.xptou.com/2023/03/13/640ecaba34fb7.png)
+ 数据输出（I/O）
  数据以本身二进制形式输出，且每个数据的字节发送顺序和其本身相反
  ![](https://imgse.com/i/ppQYyDS)
+ 数据输出（消息）
  数据以ASCII形式输出
  

